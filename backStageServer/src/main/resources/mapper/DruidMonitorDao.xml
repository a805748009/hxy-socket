<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.business.dao.DruidMonitorDao">
    <sql id="Base_DruidMonitor">
       id,sql_str,execute_count,execute_millis_max,execute_millis_total,execute_error_count,running_count,concurrent_max
    </sql>

    <update id="updateSqlMonitor" parameterType="com.hxy.nettygo.result.base.entry.backStageBean.DruidMonitor" >
        update druid_monitor
        set execute_count = execute_count+#{executeCount},
        execute_millis_max = #{executeMillisMax},
        execute_millis_total = execute_millis_total+#{executeMillisTotal},
        execute_error_count = execute_error_count+#{executeErrorCount},
        running_count = running_count+#{runningCount},
        concurrent_max = #{concurrentMax}
        where sql_str = #{sqlStr}
    </update>


    <select id="getDruidMonitor" resultType="com.hxy.nettygo.result.base.entry.backStageBean.DruidMonitor" parameterType="java.lang.String" >
        select * from druid_monitor where sql_str = #{0}
    </select>

    <insert id="insertDruidMonitor" parameterType="com.hxy.nettygo.result.base.entry.backStageBean.DruidMonitor" >
        insert into druid_monitor (<include refid="Base_DruidMonitor"/>)
        values (#{id}, #{sqlStr}, #{executeCount},
        #{executeMillisMax}, #{executeMillisTotal}, #{executeErrorCount},
        #{runningCount},#{concurrentMax})
    </insert>


</mapper>