<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.business.dao.OnlineDao">
    <!-- 所有字段 -->
    <sql id="Base_OnlineDao" >
        online_id,online_count,game_name,update_time
    </sql>
    <!--END -->

    <insert id="addOnlineCount" parameterType="com.hxy.nettygo.result.base.entry.backStageBean.OnlineCount">
        INSERT INTO online_count(
        <include refid="Base_OnlineDao" />
        )
        values ( #{onlineId},#{onlineCount},#{gameName},#{updateTime})
    </insert>

    <select id="selectOnlineCountInfo" resultType="java.util.Map">
        select SUM(online_count)as online_count,DATE_FORMAT(update_time,'%H:%i')as time,game_name
        from
        online_count
        <where>
            online_count.update_time like concat(#{time},'%')
            <if test="gameName!=null and gameName!=''">
                and game_name = #{gameName}
            </if>
        </where>
        GROUP by time
    </select>

</mapper>